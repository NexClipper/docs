<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.63">
<title data-react-helmet="true">Blog | NexClipper</title><meta data-react-helmet="true" property="og:title" content="Blog | NexClipper"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/styles.fd7d4b39.css">
<link rel="preload" href="/styles.1b757403.js" as="script">
<link rel="preload" href="/runtime~main.af12673d.js" as="script">
<link rel="preload" href="/main.ff74c94b.js" as="script">
<link rel="preload" href="/1.62db92e1.js" as="script">
<link rel="preload" href="/2.f768ce34.js" as="script">
<link rel="preload" href="/3.d382618f.js" as="script">
<link rel="preload" href="/a6aa9e1f.17c139d1.js" as="script">
<link rel="preload" href="/720845d0.d3cb196a.js" as="script">
<link rel="preload" href="/d6aae657.202144a3.js" as="script">
<link rel="preload" href="/af172acd.620e992c.js" as="script">
<link rel="preload" href="/3570154c.f3f86304.js" as="script">
<link rel="preload" href="/8e9f0a8a.fb86fad7.js" as="script">
<link rel="preload" href="/b2b675dd.c80e0afb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/NexClipper_200.svg" alt="NexClipper Logo"><strong class="navbar__title">NexClipper</strong></a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/NexClipper/NexClipper" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/NexClipper_200.svg" alt="NexClipper Logo"><strong class="navbar__title">NexClipper</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/NexClipper/NexClipper" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><main class="col col--8 col--offset-2"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/blog/2020/09/03/prometheus-exporter-exporterhub">Prometheus Exporter &amp; ExporterHub</a></h2><div class="margin-vert--md"><time datetime="2020-09-03T00:00:00.000Z" class="blogPostDate_3bQP">September 3, 2020  · 6 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/ddiiwoong" target="_blank" rel="noreferrer noopener"><img src="https://avatars1.githubusercontent.com/u/37430952?v=4" alt="Jinwoong Kim"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/ddiiwoong" target="_blank" rel="noreferrer noopener">Jinwoong Kim</a></h4><small class="avatar__subtitle">NexClipper</small></div></div></header><section class="markdown"><p>오늘은 Prometheus exporter와 관련된 내용을 다뤄보려고 합니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="prometheus-ecosystem-components"></a>Prometheus ecosystem components<a aria-hidden="true" tabindex="-1" class="hash-link" href="#prometheus-ecosystem-components" title="Direct link to heading">#</a></h3><p>프로메테우스는 기본적으로 애플리케이션 또는 써드-파티 시스템(서비스)의 메트릭을 계측(instrumentation)하게 되는데 일반적으로는 타겟(target) 엔드포인트를 통해 스크래핑(scrape)하게 됩니다.</p><ul><li>프로메테우스 포트 할당 참고 : <a href="https://github.com/prometheus/prometheus/wiki/Default-port-allocations" target="_blank" rel="noopener noreferrer">https://github.com/prometheus/prometheus/wiki/Default-port-allocations</a></li></ul><p>모든 애플리케이션이나 서비스들이 프로메테우스 호환되는 메트릭을 생성해 주지 않습니다. 그래서 프로메테우스 타겟이 되는 수집 대상은 크게 클라이언트 라이브러리와 익스포터 형태로 수집이 가능하도록 하고 있습니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="클라이언트-라이브러리client-library"></a>클라이언트 라이브러리(Client Library)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#클라이언트-라이브러리client-library" title="Direct link to heading">#</a></h3><p>서비스를 개발할 때 가장 좋은 방법은 프로메테우스 클라이언트 라이브러리를 사용해 메트릭을 코드 인라인 기반으로 직접 작성하고 계측하는 것입니다.</p><p>기본적으로 Go, Java(Scala), Python, Ruby 는 공식 라이브러리를 제공합니다.</p><ul><li>클라이언트 라이브러리 : <a href="https://prometheus.io/docs/instrumenting/clientlibs/" target="_blank" rel="noopener noreferrer">https://prometheus.io/docs/instrumenting/clientlibs/</a></li></ul><p>비공식 라이브러리는 커뮤니티에서 자체적으로 사용자들이 운영을 하기 때문에 코드 유지보수 관련해서도 문제가 될 수 있으므로 항상 릴리즈 정보를 확인하면서 사용해야 합니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="익스포터exporter"></a>익스포터(Exporter)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#익스포터exporter" title="Direct link to heading">#</a></h3><p>익스포터는 코드를 직접 수정할 수 없는 패키징된 소프트웨어나 서드-파티 시스템(서비스)등의 메트릭을 노출(expose)할 수 있습니다. 보통 벤더나 서비스 회사에서 직접 메트릭을 expose 하는 경우도 있지만 리눅스 시스템 커널이나 네트워크 장비, 스토리지, 데이터베이스와 같은 소프트웨어를 계측하기 위해서는 별도로 익스포터가 필요합니다.</p><p>거의 대부분의 모든 서비스는 커뮤니티와 사용자들이 제공하고 있고 익스포터 현황은 아래 링크에서 확인이 가능합니다.</p><ul><li>Exporter : <a href="https://prometheus.io/docs/instrumenting/exporters/" target="_blank" rel="noopener noreferrer">https://prometheus.io/docs/instrumenting/exporters/</a></li><li><a href="http://exporterhub.io" target="_blank" rel="noopener noreferrer">ExporterHub.io</a> : 넥스클라우드에서 최근 배포한 익스포터 카탈로그 리스트</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="클라이언트-라이브러리client-library-사용"></a>클라이언트 라이브러리(Client Library) 사용<a aria-hidden="true" tabindex="-1" class="hash-link" href="#클라이언트-라이브러리client-library-사용" title="Direct link to heading">#</a></h3><p>클라이언트 라이브러리 사용에 대한 간단한 예시를 보여드리고자 합니다. 코드는 일전에 spinnaker 기반 카나리 배포 테스트때 활용했던 코드를 사용하였습니다.</p><ul><li>Python 클라이언트 라이브러리 : <a href="https://github.com/prometheus/client_python" target="_blank" rel="noopener noreferrer">https://github.com/prometheus/client_python</a></li></ul><p>코드를 간단히 살펴보겠습니다. app.py는 python flask 기반으로 작성했고 prometheus_client 라이브러리를 추가한 상태로 메트릭 HTTP endpoint(:8080)를 위한 start_http_server 를 사용했습니다.</p><p>간단히 internal 500 error를 원하는 비율로 발생시키고 인위적인 메트릭으로 확인을 위해 success_rate 변수를 만들고 Gauge, Counter 로 계측을 위해서 Metric 서버(:8000)를 간단하게 구성 해봤습니다.</p><p>Counter 메트릭 타입 확인을 하기 위해 label을 http_code=&#x27;500&#x27;, http_code=&#x27;200&#x27; 로 설정합니다.</p><p>마지막으로 Gauge 메트릭 타입으로 선언하기 위해 g.set(rate_responce) 로 설정도 추가합니다.</p><blockquote><p>expose되는 endpoint나 익스포터는 위와 같이 다른 경로로 설정해도 무방하지만 /metrics 경로를 관례처럼 사용합니다. 예) <a href="http://localhost:8000/metrics" target="_blank" rel="noopener noreferrer">http://localhost:8000/metrics</a></p></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#!/usr/bin/env python from random import randrange from flask import Flask from prometheus_client import start_http_server, Gauge, Counter import sys</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">app = Flask(&#x27;python-library-test&#x27;) c = Counter(&#x27;requests&#x27;, &#x27;Number of requests served, by http code&#x27;, [&#x27;http_code&#x27;]) g = Gauge(&#x27;rate_requests&#x27;, &#x27;Rate of success requests&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">responce_500 = 0 responce_200 = 0 rate_responce = 0 success_rate = sys.argv[1] # internal 500 error를 원하는 비율로 발생시키기 위한 입력 인자</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@app.route(&#x27;/&#x27;) def hello(): global responce_500 global responce_200 global rate_responce if randrange(1, 100) &gt; int(success_rate): c.labels(http_code=&#x27;500&#x27;).inc() responce_500 = responce_500 + 1 rate_responce = responce_500 / (responce_500+responce_200) * 100 g.set(rate_responce) return &quot;Internal Server Error\\n&quot;, 500 else: c.labels(http_code=&#x27;200&#x27;).inc() responce_200 = responce_200 + 1 rate_responce = responce_500 / (responce_500+responce_200) * 100 g.set(rate_responce) return &quot;Hello World!\\n&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">start_http_server(8000) app.run(host = &#x27;0.0.0.0&#x27;, port = 8080)</span></div></div></div></div></div><p>테스트 용도이니 간단하게 로컬에서 실행합니다.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ pip install flask prometheus_client</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ python app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">py </span><span class="token number" style="color:rgb(247, 140, 108)">50</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># internal 500 error를 원하는 비율로 발생시키기 위한 입력 인자</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> Serving Flask app </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;python-library-test&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lazy loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> Environment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> production</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   WARNING</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> This </span><span class="token keyword" style="font-style:italic">is</span><span class="token plain"> a development server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> Do </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> use it </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> a production deployment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Use a production WSGI server instead</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> Debug mode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> off</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> Running on </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">//</span><span class="token number" style="color:rgb(247, 140, 108)">0.0</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Press CTRL</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">C to quit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div></div></div><p>메트릭을 수집하기 위해 간단하게 ab 명령을 활용하여 반복 호출합니다.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ab </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">n </span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">//</span><span class="token plain">localhost</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Server Software</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">        Werkzeug</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token number" style="color:rgb(247, 140, 108)">.1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Server Hostname</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">        localhost</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Server Port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">            </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Document Path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">          </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Document Length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">        </span><span class="token number" style="color:rgb(247, 140, 108)">22</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">bytes</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Concurrency Level</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">      </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Time taken </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> tests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">1.775</span><span class="token plain"> seconds</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Complete requests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">      </span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Failed requests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">        </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Non</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">2xx responses</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">      </span><span class="token number" style="color:rgb(247, 140, 108)">505</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></div></div></div></div></div><p>결과에서 자세히 봐야하는 것은 Complete requests, Non-2xx responses 입니다.</p><p>입력받은 인자인 50프로 확률로 1000번 request를 하여 에러를 발생시켰기 때문에 성공은 495번, 에러는 505번 발생한 것으로 확인할 수 있습니다.</p><p>메트릭을 확인하기 위해 expose된 8000 포트로 접속해 봅니다.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ curl localhost:8000 # HELP python_gc_objects_collected_total Objects collected during gc # TYPE python_gc_objects_collected_total counter python_gc_objects_collected_total{generation=&quot;0&quot;} 18055.0 python_gc_objects_collected_total{generation=&quot;1&quot;} 2461.0 python_gc_objects_collected_total{generation=&quot;2&quot;} 0.0 # HELP python_gc_objects_uncollectable_total Uncollectable object found during GC # TYPE python_gc_objects_uncollectable_total counter python_gc_objects_uncollectable_total{generation=&quot;0&quot;} 0.0 python_gc_objects_uncollectable_total{generation=&quot;1&quot;} 0.0 python_gc_objects_uncollectable_total{generation=&quot;2&quot;} 0.0 # HELP python_gc_collections_total Number of times this generation was collected # TYPE python_gc_collections_total counter python_gc_collections_total{generation=&quot;0&quot;} 82.0 python_gc_collections_total{generation=&quot;1&quot;} 7.0 python_gc_collections_total{generation=&quot;2&quot;} 0.0 # HELP python_info Python platform information # TYPE python_info gauge python_info{implementation=&quot;CPython&quot;,major=&quot;3&quot;,minor=&quot;8&quot;,patchlevel=&quot;3&quot;,version=&quot;3.8.3&quot;} 1.0 # HELP requests_total Number of requests served, by http code # TYPE requests_total counter requests_total{http_code=&quot;500&quot;} 505.0 requests_total{http_code=&quot;200&quot;} 495.0 # HELP requests_created Number of requests served, by http code # TYPE requests_created gauge requests_created{http_code=&quot;500&quot;} 1.5990454944853382e+09 requests_created{http_code=&quot;200&quot;} 1.599045494488697e+09 # HELP rate_requests Rate of success requests # TYPE rate_requests gauge rate_requests 50.5</span></div></div></div></div></div><p>제가 작성한 Counter인 http_code=&#x27;500&#x27;, http_code=&#x27;200&#x27; 를 보면 위 ab 에서 확인한 메트릭과 동일함을 알 수 있습니다.</p><p>그리고 Gauge로 설정한 rate_requests를 보면 success rate가 50프로의 비율임을 확인할 수 있습니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="익스포터-사용"></a>익스포터 사용<a aria-hidden="true" tabindex="-1" class="hash-link" href="#익스포터-사용" title="Direct link to heading">#</a></h3><p>저는 현재 MacOS를 사용중이고 호스트 메트릭을 확인하기 위해 node_exporter를 사용하려고 합니다.</p><ul><li>node_exporter : <a href="https://github.com/prometheus/node_exporter" target="_blank" rel="noopener noreferrer">https://github.com/prometheus/node_exporter</a></li></ul><p>node_exporter는 프로메테우스 커뮤니티에서 공식적으로 제공하고 있는 익스포터로 저는 바이너리를 받아서 같단하게 실행하려고 합니다.</p><p>위에서도 잠깐 언급했듯이 이번에 넥스클라우드에서 커뮤니티 사용자들을 위해 큐레이션 페이지로 오픈한 <a href="https://exporterhub.io" target="_blank" rel="noopener noreferrer">https://exporterhub.io</a> 에서 Node Exporter 를 탐색해보겠습니다.</p><p><img src="/assets/images/1*5hGUwC7FtdMqOxizd5UHFQ-4ad7b712b34963c48c21fa3ea5d12866.png"></p><p><a href="https://github.com/NexClipper/exporterhub.io/blob/master/lists/node/README.md" target="_blank" rel="noopener noreferrer">https://github.com/NexClipper/exporterhub.io/blob/master/lists/node/README.md</a></p><p>링크된 위 readme 페이지를 참고해서 macOS 로컬에 node_exporter를 실행합니다. 바이너리로 되어 있기 때문에 컨테이너로 실행해도 되지만 mac에서는 호스트 네트워크 관련가 있어서 직접 실행했습니다.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">wget &lt;https://github.com/prometheus/node_exporter/releases/download/v1.0.1/node_exporter-1.0.1.darwin-amd64.tar.gz&gt; tar -xzf node_exporter-1.0.1.darwin-amd64.tar.gz cd node_exporter-1.0.1.darwin-amd64 ./node_exporter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">level=info ts=2020-09-02T12:31:03.309Z caller=node_exporter.go:177 msg=&quot;Starting node_exporter&quot; version=&quot;(version=1.0.1, branch=HEAD, revision=3715be6ae899f2a9b9dbfd9c39f3e09a7bd4559f)&quot; level=info ts=2020-09-02T12:31:03.309Z caller=node_exporter.go:178 msg=&quot;Build context&quot; build_context=&quot;(go=go1.14.4, user=root@4c8e5c628328, date=20200616-12:52:07)&quot; level=info ts=2020-09-02T12:31:03.309Z caller=node_exporter.go:105 msg=&quot;Enabled collectors&quot; level=info ts=2020-09-02T12:31:03.309Z caller=node_exporter.go:112 collector=boottime level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:112 collector=cpu level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:112 collector=diskstats level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:112 collector=filesystem level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:112 collector=loadavg level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:112 collector=meminfo level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:112 collector=netdev level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:112 collector=textfile level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:112 collector=time level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:112 collector=uname level=info ts=2020-09-02T12:31:03.310Z caller=node_exporter.go:191 msg=&quot;Listening on&quot; address=:9100 level=info ts=2020-09-02T12:31:03.310Z caller=tls_config.go:170 msg=&quot;TLS is disabled and it cannot be enabled on the fly.&quot; http2=false</span></div></div></div></div></div><p>기본적으로 위에서도 언급했지만 예약된 포트정보들이 있고 /metrics 엔드포인트로 expose 되므로 <a href="http://localhost:9100/metrics" target="_blank" rel="noopener noreferrer">http://localhost:9100/metrics</a> 에 접속해 봅니다. 현재 사용중인 macbook의 머신 메트릭을 확인할 수 있습니다.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ curl </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">//</span><span class="token plain">localhost</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token number" style="color:rgb(247, 140, 108)">9100</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">metrics</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># HELP node_cpu_seconds_total Seconds the cpus spent in each mode.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># TYPE node_cpu_seconds_total counter</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;idle&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">25639.47</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;nice&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;system&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6361.26</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">12627.86</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;idle&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37124.82</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;nice&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;system&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2697.6</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4805.51</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;idle&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">26546.08</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;nice&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;system&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5505.62</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">12576.23</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;idle&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37708.71</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;nice&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;system&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2413.04</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node_cpu_seconds_total</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">cpu</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4506.18</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></div></div></div></div></div><p>이후 프로메테우스와 연동하는 과정은 설정 변경 사항이므로 따로 언급하지는 않겠습니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="exporterhubio"></a>ExporterHub.io<a aria-hidden="true" tabindex="-1" class="hash-link" href="#exporterhubio" title="Direct link to heading">#</a></h3><p><a href="http://exporterhub.io/" target="_blank" rel="noopener noreferrer">ExporterHub.io</a> 는 프로메테우스 커뮤니티 유저를 위해 제작되었고, awesome 프로젝트와 유사하게 큐레이션 리스트를 제공하는 목적으로 만들었습니다.</p><p>단순히 큐레이션 정보 뿐만 아니라 위와 같은 간단한 설치 가이드, alertrule 설정, 대시보드 관련 정보들을 한번에 볼 수 있도록 만들고 있습니다.</p><p>향후 로드맵은 다음과 같습니다.</p><ul><li>익스포터 별 alert-rule 생성</li><li>검색, 페이지 고도화, 릴리즈 업데이트 연동</li><li>NexClipper Cloud 서비스 통합</li></ul><p>하반기 중에 NexClipper Cloud 서비스를 오픈 예정이고 내년 정식 출시전에 프로메테우스 에코시스템 관련 여러가지 편의 기능을 포함 할 예정입니다.</p><p>직접 개발중인 exporter가 있으시거나 수정이나 개선사항이 있으시면 언제든지 issue, PR 부탁드립니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="정리"></a><strong>정리</strong><a aria-hidden="true" tabindex="-1" class="hash-link" href="#정리" title="Direct link to heading">#</a></h3><p>이번 포스팅에서는 프로메테우스 오픈소스의 필수 구성요소인 클라이언트 라이브러리, 익스포터에 대해서 이야기해봤습니다. 그리고 현재 개발 중인 <a href="http://exporterhub.io" target="_blank" rel="noopener noreferrer">ExporterHub.io</a> 과 향후 NexClipper의 로드맵도 같이 설명드렸습니다.</p><p>블로그 내용을 포함한 저희의 모든 기술과 제품에 대한 다양한 피드백 부탁드리고, 언제든지 궁금한 사항이 있으시거나 채용 및 기술 미팅 등 필요한 사항이 있으시면 언제든지 <a href="mailto:support@nexclipper.io" target="_blank" rel="noopener noreferrer">support@nexclipper.io</a> 로 연락 주시면 빠른 시간 내에 회신 드리도록 하겠습니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="넥스클라우드-소개-및-채용"></a><strong>넥스클라우드 소개 및 채용</strong><a aria-hidden="true" tabindex="-1" class="hash-link" href="#넥스클라우드-소개-및-채용" title="Direct link to heading">#</a></h3><p><a href="https://www.nexclipper.io/" target="_blank" rel="noopener noreferrer">넥스클라우드</a>는 컨테이너 기반 클라우드 기술 회사입니다.</p><p>2020년 하반기부터 본격적인 글로벌 사업을 위해 현재 미국 법인 설립을 진행 중이며 능력있는 분들을 모시고 있습니다.</p><p><a href="https://www.notion.so/Engineer-a83352e7b6a24bbbb1ac77bf83a7026b" target="_blank" rel="noopener noreferrer">개발자 (Engineer) 부문</a></p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/prometheus">Prometheus</a><a class="margin-horiz--sm" href="/blog/tags/exporter">Exporter</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/blog/2020/07/17/cloud-difference">은유적으로 알아보는 클라우드와 클라우드-네이티브의 차이</a></h2><div class="margin-vert--md"><time datetime="2020-07-17T00:00:00.000Z" class="blogPostDate_3bQP">July 17, 2020  · 3 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/ralfyang" target="_blank" rel="noreferrer noopener"><img src="https://avatars2.githubusercontent.com/u/4043594?v=4" alt="Ralf Yang"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/ralfyang" target="_blank" rel="noreferrer noopener">Ralf Yang</a></h4><small class="avatar__subtitle">NexClipper</small></div></div></header><section class="markdown"><p><img src="/assets/images/29292199456_5fafff72cf_c-7ee5e39b7f55d980319c746e301cf7f4.jpg">
image from <a href="https://www.flickr.com/photos/donmillertogo/29292199456/in/photolist-LCsbnE-Gd5Utj-8pFvC1-QoFNJm-Lwq9xS-4YqToQ-7eWD9E-9V3bCG-" target="_blank" rel="noopener noreferrer">flickr</a></p><p>클라우드라는 단어는 이미 IT 분야에서 흔히 쓰이는 단어가 되었다.</p><p>많은 사람들이 잘 알고 있는, 그 클라우드-컴퓨팅(Cloud computing, 이하 클라우드) 이라는 기술은, 가상화 된 컴퓨터(IT Infrastructure, 이하 IT인프라) 자원을 필요에 따라 즉시 사용하고 쉽게 폐기할 수 있도록 구성한 형태이며, IT인프라 자원 관리 부분에 있어서, 서버가 위치적으로 어디에 있는지 알 필요가 없고, 사용자 유입에 따른 대응 설계 등을 상대적으로 미리 심각하게 고려하지 않아도 되는 편리성/확장성을 제공한다.</p><p>하지만 이런 클라우드 부분에는 IT인프라 라는 단어 자체가 갖는 한계적 틀(Frame)이 존재한다.</p><p>모두 다 잘 알다시피, IT인프라 라고 하는 것은, 비즈니스 또는 공공의 이익을 위한 IT 서비스 또는 제품 제작을 위한 기반으로써 안정적으로 비즈니스가 동작하도록 도와주는 중요한 역할을 담당하고 있다.</p><p>클라우드는 이러한 IT인프라의 운영 효율 및 규모, 편리성을 극대화한 구성으로써 비즈니스의 확장에 따른 발 빠른 대응이 가능한 체제로 변화 할 수 있게 만들어 주었다.</p><p>클라우드는 이렇게 IT인프라를 효용성 높은 자원으로써 체질을 변화 시키며 발전하고 있으나, 정작 이를 활용하는 사람은 기존 관습적인 방식안에서만 클라우드를 활용 하려고 하고 있다는 부분이 바로 앞에서 말한 그 한계적인 틀이 되는 샘이다.</p><p>IT인프라는 자원/자산의 개념을 가지고 있으며, 자원과 자산은 현실, 또는 가상에서 규모와 위치를 가지게 된다.</p><p>그러다 보니, 비즈니스를 위해 동작하는 어플리케이션 하나 하나의 위치를 알아야 했으며, 그것을 잘 관리하기 위해 서로간의 관계를 중요시 생각해 왔었다.</p><p>하지만 생각해 보면, ‘구름’이라는 것이 변화하지 않고 측정 할 수 있는 직경 등을 유지하고 있으며, 어느 자리에 가면 그 구름을 볼 수 있다. 라고 말하지 않는다.</p><p>마찬가지로, 클라우드 인프라 라는 것 또한 구름의 개념으로써 접근해서 생각하고, 그에 맞는 구성으로 어플리케이션을 설계해야 하는데, 기존의 업무 방식을 기반으로 클라우드에 접근하려고 하니, 단순히 남의 회사 서버를 비싼 돈 주고 빌려쓰는 정도로 밖에 활용을 못하고 있다는 것이다.</p><p>그리고, IT인프라는 이미 효용성이 높고 즉시성을 가지며 비즈니스 변화에 따른 발빠른 대응을 준비하고 있으나, 정작 어플리케이션은 바로 배포하지 못하고, 확장 할 수 없는 구조로서 클라우드를 잘 활용하지 못하는 경우를 자주 보게 된다.</p><p>한가지 은유를 들어보면,</p><p>갑자기 페이스북이 나를 스카웃(?) 해서 바로 다음달 부터 본사로 출근을 하라고 하는데, 현지에 거주 할 집을 짓지 못해서? 좀 더 나가서, 집이 안정적으로 잘 버텨 줄 암반을 찾지 못해서 집을 지을 수 없기 때문에 나는 페이스북에 출근 할 수 없다. 라고 하는 것과 비슷하지 않을까 라는 생각을 해 본다.</p><p>비즈니스가 원하는 것은 지금 당장에 일어나는 현상에 대해 대응 할 수 있는 정도의 기반인데, 전통적인 인프라는 100년 동안 무너지지 않을 안정적인 기반을 구축 하기를 원한다.</p><p>만약 내가 페이스북 본사에 출근하게 된다면, 출근을 위해 필요한 것은 단지, 접근성, 교통수단, 식사와 잠을 해결 할 수 있는 장소만 해결되면 된다.</p><p>그런 관점에서인지 실리콘 벨리의 주차장에는 캠핑카가 그리도 많이 주차되어 있었다고 한다.</p><p>공유 경제도 같은 관점에서 볼 수 있다.</p><p>자동차나 사무실에 관련해서도, 어디에 항상 고정되어 있고 내가 소유하고 있는 개념에서의 자산적 가치를 추구하기 보다는, 내가 하는 행동에 관련해서 그 행위를 실현 시켜주기 위한 이용의 도구 개념으로 보고 접근 할 수 있도록 만들어 주는 사상이 바로 ‘공유경제’이기 때문이다.</p><p>다시 돌아와 클라우드에 관련해서 정리를 하자면,</p><p>클라우드를 인프라 개념으로써 기존의 어플리케이션을 그대로 사용하여 서비스 하기 보다는, 인프라를 유기적인 개념으로 생각하여 어플리케이션을 설계하고 서비스에 투입 할 수 있어야 한다.</p><p>클라우드-네이티브 어플리케이션 설계를 위한 방안으로 12 factor(<a href="https://12factor.net/" target="_blank" rel="noopener noreferrer">https://12factor.net</a>)에 대한 개념을 반드시 이해하고 있어야 한다.</p><p>전기차를 타면서 기존 내연기관차를 타던 방식의 패턴으로 이용해서는 안된다. 시동 버튼을 찾아 헤매고, 브레이크를 사용해서 속도를 줄이고, 정기적으로 주유하듯 충전 인프라를 찾아다니며, 비상시를 대비해 점프 스타터를 구매하고, 항상 열쇠를 지니고 다니지 않아도 된다.</p><p><strong><em>사람의 편의를 위해 시스템은 발전하고 있는데, 사람이 그 변화를 두려워 하거나 적응하지 못하는것 만큼 무의미하고 소모적인 것이 따로 없다.</em></strong></p><p>다음 글에서는 12factor의 내용을 하나씩 다뤄 볼 예정이다.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/cloud-native">CloudNative</a><a class="margin-horiz--sm" href="/blog/tags/cloud">Cloud</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/blog/welcome">Welcome</a></h2><div class="margin-vert--md"><time datetime="2019-05-30T00:00:00.000Z" class="blogPostDate_3bQP">May 30, 2019  · 1 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/yangshun" target="_blank" rel="noreferrer noopener"><img src="https://avatars0.githubusercontent.com/u/1315101?s=400&amp;v=4" alt="Yangshun Tay"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/yangshun" target="_blank" rel="noreferrer noopener">Yangshun Tay</a></h4><small class="avatar__subtitle">Front End Engineer @ Facebook</small></div></div></header><section class="markdown"><p>Blog features are powered by the blog plugin. Simply add files to the <code>blog</code> directory. It supports tags as well!</p><p>Delete the whole directory if you don&#x27;t want the blog features. As simple as that!</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/facebook">facebook</a><a class="margin-horiz--sm" href="/blog/tags/hello">hello</a><a class="margin-horiz--sm" href="/blog/tags/docusaurus">docusaurus</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/blog/hello-world">Hello</a></h2><div class="margin-vert--md"><time datetime="2019-05-29T00:00:00.000Z" class="blogPostDate_3bQP">May 29, 2019  · 1 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/endiliey" target="_blank" rel="noreferrer noopener"><img src="https://avatars1.githubusercontent.com/u/17883920?s=460&amp;v=4" alt="Endilie Yacop Sucipto"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/endiliey" target="_blank" rel="noreferrer noopener">Endilie Yacop Sucipto</a></h4><small class="avatar__subtitle">Maintainer of Docusaurus</small></div></div></header><section class="markdown"><p>Welcome to this blog. This blog is created with <a href="https://v2.docusaurus.io/" target="_blank" rel="noopener noreferrer"><strong>Docusaurus 2 alpha</strong></a>.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/hello">hello</a><a class="margin-horiz--sm" href="/blog/tags/docusaurus">docusaurus</a></div><div class="col text--right"><a aria-label="Read more about Hello" href="/blog/hello-world"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/blog/hola">Hola</a></h2><div class="margin-vert--md"><time datetime="2019-05-28T00:00:00.000Z" class="blogPostDate_3bQP">May 28, 2019  · 1 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/wgao19" target="_blank" rel="noreferrer noopener"><img src="https://avatars1.githubusercontent.com/u/2055384?v=4" alt="Gao Wei"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/wgao19" target="_blank" rel="noreferrer noopener">Gao Wei</a></h4><small class="avatar__subtitle">Docusaurus Core Team</small></div></div></header><section class="markdown"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet!!!</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/hola">hola</a><a class="margin-horiz--sm" href="/blog/tags/docusaurus">docusaurus</a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/doc2/">API Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="http://nexclipper.slack.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/nexclipper" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.facebook.com/NexClipper/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/NexClipper/NexClipper" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 NexCloud, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.1b757403.js"></script>
<script src="/runtime~main.af12673d.js"></script>
<script src="/main.ff74c94b.js"></script>
<script src="/1.62db92e1.js"></script>
<script src="/2.f768ce34.js"></script>
<script src="/3.d382618f.js"></script>
<script src="/a6aa9e1f.17c139d1.js"></script>
<script src="/720845d0.d3cb196a.js"></script>
<script src="/d6aae657.202144a3.js"></script>
<script src="/af172acd.620e992c.js"></script>
<script src="/3570154c.f3f86304.js"></script>
<script src="/8e9f0a8a.fb86fad7.js"></script>
<script src="/b2b675dd.c80e0afb.js"></script>
</body>
</html>